# ============================================================================
# SID Factory II Automation Configuration
# ============================================================================
# Purpose: Configure AutoIt hybrid automation and manual workflows
# Version: 1.0.0
# Date: 2025-12-26
# ============================================================================

[AutoIt]
# Enable AutoIt mode by default (True/False)
# NOTE: AutoIt automation disabled - editor closes during automated file loading
#       Use PyAutoGUI instead (100% reliable)
enabled = false

# Path to sf2_loader.exe (relative to project root)
# This is set after compiling scripts/autoit/sf2_loader.au3
script_path = scripts/autoit/sf2_loader.exe

# Timeout for file loading (seconds)
# How long to wait for AutoIt to load a file before giving up
timeout = 60

# Keep-alive interval (milliseconds)
# How often AutoIt sends keep-alive messages (default: 500ms)
# Note: This requires recompiling sf2_loader.au3 to change
keep_alive_interval = 500

[PyAutoGUI]
# Enable PyAutoGUI mode by default (True/False)
# PyAutoGUI is the recommended automation mode - 100% reliable
# Uses pure Python with CLI --skip-intro flag for best results
enabled = true

# Use --skip-intro CLI flag (True/False)
# Forces editor to skip intro screen and go directly to edit mode
# Recommended: True (significantly improves reliability)
skip_intro = true

# Window detection timeout (seconds)
# How long to wait for editor window to appear
window_timeout = 10

# FAILSAFE mode (True/False)
# If True, moving mouse to top-left corner aborts automation
# Recommended: True (safety feature to prevent runaway automation)
failsafe = true

[Editor]
# SID Factory II executable paths (searched in order)
# First existing path will be used
# Supports absolute paths and paths relative to project root
# NOTE: bin/SIDFactoryII.exe is rebuilt from source (Dec 26, 2025)
#       - 1.0 MB (vs 1.1 MB old binary)
#       - Built from sidfactory2-master branch
#       - Includes SDL2.dll and all dependencies
paths = bin/SIDFactoryII.exe
        C:/Program Files/SIDFactoryII/SIDFactoryII.exe
        C:/Program Files (x86)/SIDFactoryII/SIDFactoryII.exe
        C:/Users/mit/Downloads/sidfactory2-master/sidfactory2-master/Release/SIDFactoryII.exe
        C:/Users/mit/Downloads/SIDFactoryII_Win32_20231002/SIDFactoryII.exe

# Window title pattern for detecting the editor
# Used for window detection and validation
window_title = SID Factory II

# Maximum wait time for editor window to appear (seconds)
window_timeout = 10

[Playback]
# Playback control key codes (scancode format for SendMessage)
# F5 = Play, F6 = Stop, F7 = Record
# Format: VK_code (Virtual Key code)
# play_key = F5 (0x74), stop_key = F6 (0x75), record_key = F7 (0x76)
play_key = 0x74
stop_key = 0x75
record_key = 0x76

# Playback state detection intervals (milliseconds)
state_check_interval = 100
state_check_timeout = 5000

[Logging]
# Enable detailed logging for automation
enabled = true

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
level = INFO

# Log file path (relative to project root)
# Leave empty to disable file logging
log_file = logs/sf2_automation.log

# Log to console (stdout)
log_to_console = true

# Log format
# Available fields: %(asctime)s, %(name)s, %(levelname)s, %(message)s
log_format = %(asctime)s - %(name)s - %(levelname)s - %(message)s

[Validation]
# File load validation timeout (seconds)
# How long to wait for file title to appear in window
file_load_timeout = 30

# Playback validation timeout (seconds)
# How long to wait for playback state changes
playback_timeout = 5

# Require exact file name match in window title
# If False, only checks for .sf2 extension
require_exact_match = false

[Advanced]
# Use Windows API for window management (Windows only)
# If False, falls back to cross-platform psutil
use_windows_api = true

# Process name for finding running editor instances
process_name = SIDFactoryII.exe

# Maximum number of retries for window operations
max_retries = 3

# Retry delay (milliseconds)
retry_delay = 500

# ============================================================================
# NOTES
# ============================================================================
#
# 1. AutoIt Configuration:
#    - Requires AutoIt3 installed and sf2_loader.exe compiled
#    - See: scripts/autoit/README.md for compilation instructions
#    - Run: scripts/autoit/compile.bat to create sf2_loader.exe
#
# 2. Editor Paths:
#    - First existing path will be used automatically
#    - Add your custom installation path to the list
#    - Paths are checked in order from top to bottom
#
# 3. Logging:
#    - Logs are created in logs/ directory (created automatically)
#    - Set level to DEBUG for troubleshooting
#    - Set enabled to false to disable all logging
#
# 4. Manual Workflow:
#    - If AutoIt is disabled or unavailable, manual workflow is used
#    - User will be prompted to load file manually
#    - See: docs/guides/SF2_EDITOR_MANUAL_WORKFLOW_GUIDE.md
#
# 5. Platform Support:
#    - AutoIt: Windows only
#    - Manual workflow: Cross-platform (Windows/Mac/Linux)
#    - Windows API: Windows only (falls back to psutil on other platforms)
#
# ============================================================================
